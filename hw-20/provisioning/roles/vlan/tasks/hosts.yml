---
- name: Copy ifcfg files for VLAN on host
  template:
    src: "{{ item }}"
    dest: /etc/sysconfig/network-scripts/{{ item | basename | regex_replace('\.j2$', '') }}
  with_fileglob:
    - "{{ role_path }}/templates/hosts/*.j2"
  when: vlan_number is defined
  notify:
    - Restart network

- name: Check if ifcfg-vlan exists
  stat:
    path: /etc/sysconfig/network-scripts/ifcfg-vlan
  register: stat_vlan

- name: Add number to ifcfg-vlan
  command: mv /etc/sysconfig/network-scripts/ifcfg-vlan /etc/sysconfig/network-scripts/ifcfg-vlan{{ vlan_number }}
  when:
    - vlan_number is defined
    - stat_vlan.stat.exists
